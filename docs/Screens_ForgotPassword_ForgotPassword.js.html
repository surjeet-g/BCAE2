<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Screens/ForgotPassword/ForgotPassword.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Screens/ForgotPassword/ForgotPassword.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import moment from "moment";
import React, { useEffect, useState } from "react";
import {
  Image, ImageBackground, Pressable, ScrollView, StyleSheet, Text, View
} from "react-native";
import DatePicker from "react-native-date-picker";
import { TextInput, useTheme } from "react-native-paper";
import { useDispatch, useSelector } from "react-redux";
import { CustomButton } from "../../Components/CustomButton";
import { CustomInput } from "../../Components/CustomInput";
import { StickyFooter } from "../../Components/StickyFooter";
import { Toast } from "../../Components/Toast";
import { ToggleButton } from "../../Components/ToggleButton";
import {
  color, fontSizes, spacing, validateEmail
} from "../../Utilities/Constants/Constant";
import { strings } from "../../Utilities/Language";
import {
  resetForgotPassword,
  verifyForgotPasswordData
} from "../ForgotPassword/ForgotPasswordDispatcher.js";
import { HeaderTitle } from "./../../Components/headerTitle";

/**
 * ForgotPassword :user/customer can able to change password
 * @namespace ForgotPassword  
 */
const ForgotPassword = ({ navigation }) => {
  let login = useSelector((state) => state.login);
  const { colors } = useTheme();

  let forgot = useSelector((state) => state.forgot);
  // const [username, setUsername] = useState("vvvipindsm@gmail.com");
  const [username, setUsername] = useState("");
  const [usernameError, setUsernameError] = useState("");
  // const [lastName, setlastName] = useState("vvv");
  const [customerId, setCustomerId] = useState("");
  const [customerIdError, setCustomerIdError] = useState("");
  const [lastName, setlastName] = useState("");
  const [lastNameError, setlastNameError] = useState("");
  const [dob, setDob] = useState("");
  // const [dob, setDob] = useState("2023-02-10");
  const [dobError, setDobError] = useState("");
  const [open, setOpen] = useState(false);
  const isFirst = true;
  const [isFirstSelected, setFirstSelected] = useState(isFirst);

  const onPressFirst = () => {
    setFirstSelected(true);
  };
  const onPressSecond = () => {
    setFirstSelected(false);
  };
  useEffect(() => {
    setCustomerId("");
    setCustomerIdError("");
    setUsername("");
    setUsernameError("");
    setlastNameError("");
    setDob("");
    setDobError("");
    setOpen(false);
  }, []);
  const dispatch = useDispatch([verifyForgotPasswordData, resetForgotPassword]);

  const onIDChange = (textStr) => {
    setUsername(textStr);
    // if (textStr.length == 0) {
    //   dispatch(resetForgotPassword());
    // }
    setUsernameError("");
  };

  const onIDChangeUsername = (textStr) => {
    setlastName(textStr);
    setlastNameError("");
  };

  const clearTextClick = () => {
    setUsername("");
    dispatch(resetForgotPassword());
    setUsernameError(strings.emailValidError);
  };
  const clearCustomerIdClick = () => {
    setUsername("");
    // dispatch(resetForgotPassword());
    setUsernameError(strings.customerIdValidError);
  };
  const clearLastnameClick = () => {
    setlastName("");
    // dispatch(resetForgotPassword());
    setlastNameError(strings.lastnameValidError);
  };
  /**
  * User/Customer can able change password by sumbitting loginID
  * @memberOf ForgotPassword
  */
  const submitEmail = () => {
    if (!validateEmail(username)) {
      setUsernameError(strings.emailValidError);
    } else {
      //to do api call
      const params = {
        loginId: username,
      };

      dispatch(verifyForgotPasswordData(navigation, params));
    }
  };
  /**
 * User/Customer can able change password by sumbitting loginId,LastName,dob
 * @memberOf ForgotPassword
 */
  const submitCustomerId = () => {
    if (customerId == "") {
      setCustomerIdError(strings.customerIDError);
    } else if (lastName == "") {
      setlastNameError("Last Name is required");
    } else if (dob == "") {
      setDobError("Date of birth is required");
    } else {
      dispatch(
        verifyForgotPasswordData(
          navigation,
          {
            loginId: customerId,
            lastName: lastName,
            dob: moment(dob).format("YYYY-MM-DD"),
          },
          "customerID"
        )
      );
    }
  };
  const showErrorMessage = (errMessage) => {
    return (
      &lt;View style={{ marginTop: spacing.HEIGHT_6, flexDirection: "row" }}>
        &lt;Image
          style={styles.errorLogo}
          source={require("../../Assets/icons/ci_error_warning.png")}
        />
        &lt;Text style={styles.errorText}>{errMessage}&lt;/Text>
      &lt;/View>
    );
  };
  const onCustomerIDChange = (textStr) => {
    setCustomerId(textStr);
    // if (textStr.length == 0) {
    //   dispatch(resetForgotPassword());
    // }
    setCustomerIdError("");
  };
  const onDismissSingle = React.useCallback(() => {
    setOpen(false);
  }, [setOpen]);

  const onConfirmSingle = React.useCallback(
    (params) => {
      setOpen(false);
      setDob(params.date);
      setDobError("");
    },
    [setOpen, setDob]
  );
  return (
    &lt;ImageBackground
      style={styles.container}
      source={require("../../Assets/icons/bg_others.png")}
      resizeMode="cover"
    >
      &lt;HeaderTitle header="Need our help," subHeader="Forgot password?" />
      &lt;ScrollView
        style={{
          flexGrow: 1,
          // paddingHorizontal: spacing.WIDTH_30,
        }}
        nestedScrollEnabled={true}
      >
        &lt;View
          style={{
            margin: 10,
            flex: 1,
            padding: 20,
            backgroundColor: "#fff",
            borderRadius: 16,
            elevation: 5,
          }}
        >
          &lt;View style={{ marginBottom: spacing.WIDTH_20 }}>
            &lt;ToggleButton
              isFirstSelected={isFirstSelected}
              label={{
                first: strings.customer_email_ID,
                second: strings.loginId,
              }}
              bgColor={{
                selected: color.BCAE_PRIMARY,
                unselected: color.BCAE_LIGHT_BLUE_2,
              }}
              textColor={{
                selected: color.WHITE,
                unselected: color.BCAE_PRIMARY,
              }}
              textPro={{
                fontSize: fontSizes.FONT_13,
                fontWeight: "600",
                // lineHeight: spacing.HEIGHT_16,
              }}
              onPressFirst={onPressFirst}
              onPressSecond={onPressSecond}
            >&lt;/ToggleButton>
          &lt;/View>
          {isFirstSelected ? (
            &lt;View>
              &lt;View style={{ marginBottom: spacing.HEIGHT_20 }}>
                &lt;CustomInput
                  onChangeText={(text) => onIDChange(text)}
                  value={username}
                  caption={strings.customer_email_ID}
                  placeHolder={strings.customer_email_ID}
                  right={
                    username &amp;&amp; (
                      &lt;TextInput.Icon
                        onPress={clearTextClick}
                        theme={{ colors: { onSurfaceVariant: colors.gray } }}
                        style={{ width: 23, height: 23 }}
                        icon="close"
                      />
                    )
                  }
                />

                {usernameError !== "" &amp;&amp; showErrorMessage(usernameError)}
              &lt;/View>
            &lt;/View>
          ) : (
            &lt;View>
              &lt;View style={{ marginBottom: spacing.HEIGHT_20 }}>
                &lt;CustomInput
                  onChangeText={(text) => onCustomerIDChange(text)}
                  value={customerId}
                  caption={strings.loginId}
                  placeHolder={strings.loginId}
                  right={
                    customerId &amp;&amp; (
                      &lt;TextInput.Icon
                        onPress={clearCustomerIdClick}
                        theme={{ colors: { onSurfaceVariant: colors.gray } }}
                        style={{ width: 23, height: 23 }}
                        icon="close"
                      />
                    )
                  }
                />
                {usernameError !== "" &amp;&amp; showErrorMessage(usernameError)}
                &lt;CustomInput
                  onChangeText={(text) => {
                    onIDChangeUsername(text);
                  }}
                  value={lastName}
                  caption={strings.last_name}
                  placeHolder={strings.last_name}
                  right={
                    lastName &amp;&amp; (
                      &lt;TextInput.Icon
                        onPress={clearLastnameClick}
                        theme={{ colors: { onSurfaceVariant: colors.gray } }}
                        style={{ width: 23, height: 23 }}
                        icon="close"
                      />
                    )
                  }
                />
                {lastNameError !== "" &amp;&amp; showErrorMessage(lastNameError)}
                &lt;DatePicker
                  modal
                  mode="date"
                  validRange={{ endDate: new Date() }}
                  open={open}
                  onCancel={() => setOpen(false)}
                  date={dob == "" ? new Date() : dob}
                  maximumDate={new Date()}
                  onConfirm={(params) => {
                    console.log("data", params);
                    setOpen(false);
                    setDob(params);
                    setDobError("");
                  }}
                />
                &lt;CustomInput
                  // onChangeText={(text) => onIDChange(text)}
                  value={dob == "" ? "" : moment(dob).format("YYYY-MM-DD")}
                  caption={"Date of birth"}
                  onFocus={() => setOpen(true)}
                  placeHolder={"Date of birth"}
                  right={
                    &lt;TextInput.Icon
                      onPress={() => setOpen(true)}
                      style={{ width: 23, height: 23 }}
                      theme={{ colors: { onSurfaceVariant: colors.gray } }}
                      icon={"calendar"}
                    />
                  }
                />
                {dobError !== "" &amp;&amp; showErrorMessage(dobError)}
              &lt;/View>
            &lt;/View>
          )}
        &lt;/View>
        &lt;View
          style={{
            flexDirection: "row",
            alignItems: "center",
            justifyContent: "center",
            marginTop: 35,
          }}
        >
          &lt;Pressable onPress={() => navigation.goBack()}>
            &lt;Text style={styles.backToLogin}>{strings.back_to_login}&lt;/Text>
          &lt;/Pressable>
        &lt;/View>
        &lt;View
          style={{
            flexDirection: "row",
            justifyContent: "center",
            marginVertical: 30,
          }}
        >
          &lt;Text style={styles.noAccText}>{strings.dont_account} &lt;/Text>
          &lt;Pressable
            onPress={() => navigation.navigate("Register with us", {})}
          >
            &lt;Text style={styles.rgisterText}>{strings.register}&lt;/Text>
          &lt;/Pressable>
        &lt;/View>
        &lt;View style={{ paddingBottom: spacing.HEIGHT_40 * 3 }} />
      &lt;/ScrollView>

      {!login.initLogin &amp;&amp;
        (login?.loggedProfile?.errorCode == "10000" ||
          login?.loggedProfile?.errorCode == "10001") &amp;&amp; (
          &lt;View style={styles.toast}>
            &lt;Toast
              bgColor={color.TOAST_RED}
              customStyle={{ paddingHorizontal: spacing.WIDTH_30 }}
              textPro={{
                color: color.WHITE,
                fontSize: fontSizes.FONT_14,
                fontWeight: "700",
              }}
              img={
                login?.loggedProfile?.errorCode == "10001"
                  ? require("../../Assets/icons/ic_no_Internet.png")
                  : require("../../Assets/icons/ci_error-warning-fill.png")
              }
              message={
                login?.loggedProfile?.errorCode == "10001"
                  ? strings.no_network
                  : strings.something_went_wrong
              }
            />
          &lt;/View>
        )}
      &lt;StickyFooter isLogin={true}>
        {/* Login View */}
        &lt;View>
          &lt;CustomButton
            loading={forgot?.initForgotPassword}
            label={strings.reset_password}
            isDisabled={
              isFirstSelected
                ? !validateEmail(username)
                : customerId == "" || dob == "" || lastName == ""
                  ? true
                  : false
            }
            onPress={isFirstSelected ? submitEmail : submitCustomerId}
          />
        &lt;/View>
        &lt;Text
          style={{
            color: "#393939",
            fontSize: fontSizes.FONT_14,
            textAlign: "center",
            fontWeight: "400",
            marginTop: 10,
          }}
        >
          By continuing, I accept and agree to Dtworks
        &lt;/Text>
        &lt;View style={{ flexDirection: "row", justifyContent: "center" }}>
          &lt;Text
            style={{
              fontSize: fontSizes.FONT_14,
              textAlign: "center",
              fontWeight: "600",
              color: "#4B3694",
              marginTop: 5,
            }}
            onPress={() => alert("Navigate to T&amp;C")}
          >
            Terms &amp; Conditions of Use
          &lt;/Text>
          &lt;Text
            style={{
              fontSize: fontSizes.FONT_14,
              textAlign: "center",
              fontWeight: "600",
              color: "#000000",
              marginTop: 5,
            }}
          >
            {" "}
            &amp;{" "}
          &lt;/Text>
          &lt;Text
            style={{
              fontSize: fontSizes.FONT_14,
              textAlign: "center",
              fontWeight: "600",
              color: "#4B3694",
              marginTop: 5,
            }}
            onPress={() => alert("Navigate to Privacy Policy")}
          >
            Privacy Policy
          &lt;/Text>
        &lt;/View>
        &lt;Text
          style={{
            color: "#393939",
            fontSize: fontSizes.FONT_12,
            textAlign: "center",
            fontWeight: "400",
            marginTop: 10,
          }}
        >
          Â© {new Date().getFullYear()} Dtworks. All rights reserved.
        &lt;/Text>
      &lt;/StickyFooter>
    &lt;/ImageBackground>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: color.BCAE_OFF_WHITE,
  },
  logo: {
    height: 128,
    width: 128,
  },
  toast: {
    position: "absolute",
    bottom: spacing.HEIGHT_31 * 2,
  },
  orText: {
    color: color.BCAE_LIGHT_BLUE,
    fontSize: fontSizes.FONT_10,
    fontWeight: "500",
    lineHeight: spacing.WIDTH_16,
    paddingHorizontal: spacing.WIDTH_7,
  },
  noAccText: {
    color: "#3D3D3D",
    fontSize: fontSizes.FONT_16,
    lineHeight: spacing.WIDTH_16,
    textAlign: "center",
    fontWeight: "400",
  },
  rgisterText: {
    fontWeight: 700,
    color: "#4B3694",
    fontSize: fontSizes.FONT_16,
    lineHeight: spacing.WIDTH_17,
    textAlign: "center",
  },
  backToLogin: {
    fontWeight: 700,
    color: "#4B3694",
    fontSize: fontSizes.FONT_18,
    lineHeight: spacing.WIDTH_17,
    textAlign: "center",
  },
  upperText: {
    color: color.PLACEHOLDER,
    fontSize: fontSizes.FONT_12,
    fontWeight: "500",
    marginTop: 5,
    lineHeight: spacing.WIDTH_14,
  },
  upperLogo: {
    width: spacing.WIDTH_16,
    height: spacing.WIDTH_16,
  },
});

export default ForgotPassword;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Components.html">Components</a></li><li><a href="EditProfile.html">EditProfile</a></li><li><a href="ForgotPassword.html">ForgotPassword</a></li><li><a href="Interaction.html">Interaction</a></li><li><a href="Login.html">Login</a></li><li><a href="Register.html">Register</a></li><li><a href="Splash.html">Splash</a></li><li><a href="ViewProfile.html">ViewProfile</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Jul 25 2023 14:28:02 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
