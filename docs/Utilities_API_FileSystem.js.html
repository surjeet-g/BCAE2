<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Utilities/API/FileSystem.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Utilities/API/FileSystem.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Platform } from "react-native";
import FileViewer from "react-native-file-viewer";
import {
  checkMultiple, PERMISSIONS, requestMultiple
} from "react-native-permissions";
import Share from "react-native-share";
import RNFetchBlob from "rn-fetch-blob";

/**
* handles share files both android and IOS
* @method
* @param {string} base64String input base64 data
* @param {string} fileType file type of given file
* @param {string} filesName file name of given file
*/
export const ShareDoc = async (
  base64String,
  fileType = "image/png",
  fileName = "doc"
) => {
  if (Platform.OS !== "ios") {
    const shareOption = {
      url: "data:" + fileType + ";base64," + base64String,
      filename: fileName,
    };
    await Share.open(shareOption);
  } else {
    const dirs = RNFetchBlob.fs.dirs;
    const path = dirs.DocumentDir + "/" + fileName + ".png";
    RNFetchBlob.fs
      .writeFile(path, base64String, "base64")
      .then((result) => {
        Share.open({
          subject: "Document",
          url: path,
        });
      })
      .catch((err) => {
        console.log("error", err);
      });
  }
};
/**
* handle the file download from base64Data
* @method
* @param {string} base64Data input base64 data
* @param {string} filesName file name of given file
*/
export const downloadFile = async (base64Data, filesName = "sample.pdf") => {
  const fileArr = filesName.split(".");

  const ext = fileArr[1];

  const fileName = fileArr[0];

  const baseArr = base64Data.split("base64,");
  base64Data = baseArr[1];
  let fileType = baseArr[0];
  fileType = fileType.replace("data:", "");
  fileType = fileType.replace(";", "");
  await permission();
  let date = new Date();
  const { config, fs } = RNFetchBlob;

  const dirPath =
    Platform.OS === "ios"
      ? `${fs.dirs.DocumentDir}/bcae`
      : `${fs.dirs.DocumentDir}`;

  const filePath =
    dirPath +
    "/" +
    Math.floor(date.getTime() + date.getSeconds() / 2) +
    "." +
    ext;

  fs.writeFile(filePath, base64Data, "base64")
    .then(async (res) => {
      if (Platform.OS === "ios") {
        try {
          await ShareDoc(base64Data, fileType, fileName);
        } catch (err) {
          console.log("getting error while sharing");
        }
        return null;
      } else {
        RNFetchBlob.fs.scanFile([{ path: filePath, mime: fileType }]);
        const path = FileViewer.open(filePath, { showOpenWithDialog: true }) // absolute-path-to-my-local-file.
          .then(() => {
            console.log("point opened ");
            // success
          })
          .catch(async (error) => {
            // error
            try {
              await ShareDoc(base64Data, fileType, fileName);
            } catch (err) {
              console.log("getting error while sharing");
            }

            console.log("point error  ", error);
          });
      }

      return null;

      // Platform.OS === "android" &amp;&amp;
      // Alert.alert("success", "image Successfully downloaded!!");
    })
    .catch((err) => console.log("err", err));
};
/**
* handle premission for storage access
* @method
*/
const permission = async () => {
  const checkPermission = await checkMultiple(
    Platform.OS === "android"
      ? [
        PERMISSIONS.ANDROID.WRITE_EXTERNAL_STORAGE,
        PERMISSIONS.ANDROID.READ_EXTERNAL_STORAGE,
      ]
      : [PERMISSIONS.IOS.PHOTO_LIBRARY, PERMISSIONS.IOS.PHOTO_LIBRARY_ADD_ONLY]
  );
  if (
    checkPermission["ios.permission.PHOTO_LIBRARY"] === "denied" ||
    checkPermission["ios.permission.PHOTO_LIBRARY_ADD_ONLY"] === "denied" ||
    checkPermission["android.permission.WRITE_EXTERNAL_STORAGE"] == "denied" ||
    checkPermission["android.permission.READ_EXTERNAL_STORAGE"] == "denied"
  ) {
    const requestPermission = await requestMultiple(
      Platform.OS === "android"
        ? [
          PERMISSIONS.ANDROID.WRITE_EXTERNAL_STORAGE,
          PERMISSIONS.ANDROID.READ_EXTERNAL_STORAGE,
        ]
        : [
          PERMISSIONS.IOS.PHOTO_LIBRARY,
          PERMISSIONS.IOS.PHOTO_LIBRARY_ADD_ONLY,
        ]
    );
  }
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="CustomerOnBoarding.html">CustomerOnBoarding</a></li><li><a href="EditProfile.html">EditProfile</a></li><li><a href="ForgotPassword.html">ForgotPassword</a></li><li><a href="Interaction.html">Interaction</a></li><li><a href="Login.html">Login</a></li><li><a href="Register.html">Register</a></li><li><a href="Splash.html">Splash</a></li><li><a href="ViewProfile.html">ViewProfile</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CheckGroupbox">CheckGroupbox</a></li><li><a href="global.html#CustomActivityIndicator">CustomActivityIndicator</a></li><li><a href="global.html#CustomButton">CustomButton</a></li><li><a href="global.html#CustomDropDown">CustomDropDown</a></li><li><a href="global.html#CustomDropDownFullWidth">CustomDropDownFullWidth</a></li><li><a href="global.html#CustomErrorText">CustomErrorText</a></li><li><a href="global.html#CustomInput">CustomInput</a></li><li><a href="global.html#FooterModel">FooterModel</a></li><li><a href="global.html#ImagePicker">ImagePicker</a></li><li><a href="global.html#ShareDoc">ShareDoc</a></li><li><a href="global.html#StickyFooter">StickyFooter</a></li><li><a href="global.html#TextBoxWithCTA">TextBoxWithCTA</a></li><li><a href="global.html#TextBoxWithCTAEmail">TextBoxWithCTAEmail</a></li><li><a href="global.html#ToastTemplete">ToastTemplete</a></li><li><a href="global.html#ToggleButton">ToggleButton</a></li><li><a href="global.html#downloadFile">downloadFile</a></li><li><a href="global.html#getCustomerID">getCustomerID</a></li><li><a href="global.html#getCustomerUUID">getCustomerUUID</a></li><li><a href="global.html#getFcmDeviceId">getFcmDeviceId</a></li><li><a href="global.html#getUserId">getUserId</a></li><li><a href="global.html#getUserType">getUserType</a></li><li><a href="global.html#notificationListener">notificationListener</a></li><li><a href="global.html#permission">permission</a></li><li><a href="global.html#requestUserPermission">requestUserPermission</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Thu Jul 27 2023 10:23:59 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
